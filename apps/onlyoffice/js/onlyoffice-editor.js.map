{"version":3,"file":"onlyoffice-editor.js?v=6ca24941f1157f489639","mappings":"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","sources":["webpack:///onlyoffice/src/editor.js"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2025\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n/* global _, DocsAPI, jQuery, moment, oc_defaults */\n\n/**\n * @param {object} $ JQueryStatic object\n * @param {object} OCA Nextcloud OCA object\n */\n(function($, OCA) {\n\n\tOCA.Onlyoffice = _.extend({\n\t\tAppName: 'onlyoffice',\n\t\tinframe: false,\n\t\tinviewer: false,\n\t\tfileId: null,\n\t\tshareToken: null,\n\t\tinsertImageType: null,\n\t}, OCA.Onlyoffice)\n\n\tOCA.Onlyoffice.InitEditor = function() {\n\n\t\tOCA.Onlyoffice.fileId = $('#iframeEditor').data('id')\n\t\tOCA.Onlyoffice.shareToken = $('#iframeEditor').data('sharetoken')\n\t\tOCA.Onlyoffice.directToken = $('#iframeEditor').data('directtoken')\n\t\tOCA.Onlyoffice.template = $('#iframeEditor').data('template')\n\t\tOCA.Onlyoffice.inframe = !!$('#iframeEditor').data('inframe')\n\t\tOCA.Onlyoffice.inviewer = !!$('#iframeEditor').data('inviewer')\n\t\tOCA.Onlyoffice.filePath = $('#iframeEditor').data('path')\n\t\tOCA.Onlyoffice.anchor = $('#iframeEditor').attr('data-anchor')\n\t\tOCA.Onlyoffice.currentWindow = window\n\t\tOCA.Onlyoffice.currentUser = OC.getCurrentUser()\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\tOCA.Onlyoffice.currentWindow = window.parent\n\t\t\tOCA.Onlyoffice.currentUser = OCA.Onlyoffice.currentWindow.OC.getCurrentUser()\n\t\t}\n\n\t\tif (!OCA.Onlyoffice.fileId && !OCA.Onlyoffice.shareToken && !OCA.Onlyoffice.directToken) {\n\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'FileId is empty'), 'error', { timeout: -1 })\n\t\t\treturn\n\t\t}\n\n\t\tconst configUrl = OCA.Onlyoffice.getConfigUrl()\n\n\t\t$.ajax({\n\t\t\turl: configUrl,\n\t\t\tsuccess: function onSuccess(config) {\n\t\t\t\tif (config) {\n\t\t\t\t\tOCA.Onlyoffice.device = config.type\n\t\t\t\t\tif (OCA.Onlyoffice.device === 'mobile') {\n\t\t\t\t\t\tOCA.Onlyoffice.resizeEvents()\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.redirectUrl) {\n\t\t\t\t\t\tlocation.href = config.redirectUrl\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.error != null) {\n\t\t\t\t\t\tOCA.Onlyoffice.showMessage(config.error, 'error', { timeout: -1 })\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!config.documentServerUrl) {\n\t\t\t\t\t\tOCA.Onlyoffice.showMessage('ONLYOFFICE cannot be reached. Please contact admin', 'error', { timeout: -1 })\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst script = document.createElement('script')\n\t\t\t\t\tscript.src = config.documentServerUrl + 'web-apps/apps/api/documents/api.js?shardKey=' + config.document.key\n\t\t\t\t\tscript.setAttribute('nonce', btoa(OC.requestToken))\n\t\t\t\t\tscript.onerror = function() {\n\t\t\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'ONLYOFFICE cannot be reached. Please contact admin'), 'error', { timeout: -1 })\n\t\t\t\t\t}\n\t\t\t\t\tscript.onload = function() {\n\t\t\t\t\t\tif (typeof DocsAPI === 'undefined') {\n\t\t\t\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'ONLYOFFICE cannot be reached. Please contact admin'), 'error', { timeout: -1 })\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst docsVersion = DocsAPI.DocEditor.version().split('.')\n\t\t\t\t\t\tif ((docsVersion[0] < 6)\n\t\t\t\t\t\t\t|| (parseInt(docsVersion[0]) === 6 && parseInt(docsVersion[1]) === 0)) {\n\t\t\t\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'Not supported version'), 'error', { timeout: -1 })\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet docIsChanged = null\n\t\t\t\t\t\tlet docIsChangedTimeout = null\n\n\t\t\t\t\t\tconst setPageTitle = function(event) {\n\t\t\t\t\t\t\tclearTimeout(docIsChangedTimeout)\n\n\t\t\t\t\t\t\tif (docIsChanged !== event.data) {\n\t\t\t\t\t\t\t\tconst titleChange = function() {\n\t\t\t\t\t\t\t\t\tOCA.Onlyoffice.currentWindow.document.title = config.document.title + (event.data ? ' *' : '') + ' - ' + oc_defaults.title\n\t\t\t\t\t\t\t\t\tdocIsChanged = event.data\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (event === false || event.data) {\n\t\t\t\t\t\t\t\t\ttitleChange()\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdocIsChangedTimeout = setTimeout(titleChange, 500)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetPageTitle(false)\n\n\t\t\t\t\t\tOCA.Onlyoffice.documentType = config.documentType\n\n\t\t\t\t\t\tconfig.events = {\n\t\t\t\t\t\t\tonDocumentStateChange: setPageTitle,\n\t\t\t\t\t\t\tonDocumentReady: OCA.Onlyoffice.onDocumentReady,\n\t\t\t\t\t\t\tonMakeActionLink: OCA.Onlyoffice.onMakeActionLink,\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (config.editorConfig.tenant) {\n\t\t\t\t\t\t\tconfig.events.onAppReady = function() {\n\t\t\t\t\t\t\t\tOCA.Onlyoffice.docEditor.showMessage(t(OCA.Onlyoffice.AppName, 'You are using public demo ONLYOFFICE Docs server. Please do not store private sensitive data.'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ((OCA.Onlyoffice.inframe && !OCA.Onlyoffice.shareToken)\n\t\t\t\t\t\t\t|| (OCA.Onlyoffice.currentUser.uid)) {\n\t\t\t\t\t\t\tconfig.events.onRequestSaveAs = OCA.Onlyoffice.onRequestSaveAs\n\t\t\t\t\t\t\tconfig.events.onRequestInsertImage = OCA.Onlyoffice.onRequestInsertImage\n\t\t\t\t\t\t\tconfig.events.onRequestMailMergeRecipients = OCA.Onlyoffice.onRequestMailMergeRecipients\n\t\t\t\t\t\t\tconfig.events.onRequestCompareFile = OCA.Onlyoffice.onRequestSelectDocument // todo: remove (for editors 7.4)\n\t\t\t\t\t\t\tconfig.events.onRequestSelectDocument = OCA.Onlyoffice.onRequestSelectDocument\n\t\t\t\t\t\t\tconfig.events.onRequestSendNotify = OCA.Onlyoffice.onRequestSendNotify\n\t\t\t\t\t\t\tconfig.events.onRequestReferenceData = OCA.Onlyoffice.onRequestReferenceData\n\t\t\t\t\t\t\tconfig.events.onRequestOpen = OCA.Onlyoffice.onRequestOpen\n\t\t\t\t\t\t\tconfig.events.onRequestReferenceSource = OCA.Onlyoffice.onRequestReferenceSource\n\t\t\t\t\t\t\tconfig.events.onMetaChange = OCA.Onlyoffice.onMetaChange\n\t\t\t\t\t\t\tconfig.events.onRequestRefreshFile = OCA.Onlyoffice.onRequestRefreshFile\n\n\t\t\t\t\t\t\tif (OCA.Onlyoffice.currentUser.uid) {\n\t\t\t\t\t\t\t\tconfig.events.onRequestUsers = OCA.Onlyoffice.onRequestUsers\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!OCA.Onlyoffice.filePath) {\n\t\t\t\t\t\t\t\tOCA.Onlyoffice.filePath = config._file_path\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!OCA.Onlyoffice.template) {\n\t\t\t\t\t\t\t\tconfig.events.onRequestHistory = OCA.Onlyoffice.onRequestHistory\n\t\t\t\t\t\t\t\tconfig.events.onRequestHistoryData = OCA.Onlyoffice.onRequestHistoryData\n\t\t\t\t\t\t\t\tconfig.events.onRequestRestore = OCA.Onlyoffice.onRequestRestore\n\t\t\t\t\t\t\t\tconfig.events.onRequestHistoryClose = OCA.Onlyoffice.onRequestHistoryClose\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (OCA.Onlyoffice.directEditor || OCA.Onlyoffice.inframe) {\n\t\t\t\t\t\t\tconfig.events.onRequestClose = OCA.Onlyoffice.onRequestClose\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (OCA.Onlyoffice.inframe\n\t\t\t\t\t\t\t&& config._files_sharing && !OCA.Onlyoffice.shareToken\n\t\t\t\t\t\t\t&& window.parent.OCA.Onlyoffice.context) {\n\t\t\t\t\t\t\tconfig.events.onRequestSharingSettings = OCA.Onlyoffice.onRequestSharingSettings\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tOCA.Onlyoffice.docEditor = new DocsAPI.DocEditor('iframeEditor', config)\n\n\t\t\t\t\t\tif (OCA.Onlyoffice.directEditor) {\n\t\t\t\t\t\t\tOCA.Onlyoffice.directEditor.loaded()\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!OCA.Onlyoffice.directEditor\n\t\t\t\t\t\t\t&& config.type === 'mobile' && $('#app > iframe').css('position') === 'fixed') {\n\t\t\t\t\t\t\t$('#app > iframe').css('height', 'calc(100% - 50px)')\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst favicon = OC.filePath(OCA.Onlyoffice.AppName, 'img', OCA.Onlyoffice.documentType + '.ico')\n\t\t\t\t\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\t\t\t\t\twindow.parent.postMessage({\n\t\t\t\t\t\t\t\tmethod: 'changeFavicon',\n\t\t\t\t\t\t\t\tparam: favicon,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'*')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('link[rel=\"icon\"]').attr('href', favicon)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdocument.head.appendChild(script)\n\t\t\t\t}\n\t\t\t},\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestHistory = function(version) {\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/history?fileId={fileId}',\n\t\t\t{\n\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tOCA.Onlyoffice.refreshHistory(response, version)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestHistoryData = function(event) {\n\t\tconst version = event.data\n\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/version?fileId={fileId}&version={version}',\n\t\t\t{\n\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t\tversion,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tresponse = {\n\t\t\t\t\terror: response.error,\n\t\t\t\t\tversion,\n\t\t\t\t}\n\t\t\t}\n\t\t\tOCA.Onlyoffice.docEditor.setHistoryData(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestRestore = function(event) {\n\t\tconst version = event.data.version\n\n\t\t$.ajax({\n\t\t\tmethod: 'PUT',\n\t\t\turl: OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/restore'),\n\t\t\tdata: {\n\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t\tversion,\n\t\t\t},\n\t\t\tsuccess: function onSuccess(response) {\n\t\t\t\tOCA.Onlyoffice.refreshHistory(response, response.at(-1).version)\n\n\t\t\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\t\t\twindow.parent.postMessage({\n\t\t\t\t\t\tmethod: 'onRefreshVersionsDialog',\n\t\t\t\t\t},\n\t\t\t\t\t'*')\n\t\t\t\t}\n\t\t\t},\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestHistoryClose = function() {\n\t\tlocation.reload(true)\n\t}\n\n\tOCA.Onlyoffice.onDocumentReady = function() {\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'onDocumentReady',\n\t\t\t\tparam: {},\n\t\t\t},\n\t\t\t'*')\n\t\t}\n\n\t\tOCA.Onlyoffice.resize()\n\t\tOCA.Onlyoffice.setViewport()\n\t}\n\n\tOCA.Onlyoffice.onRequestSaveAs = function(event) {\n\t\tconst saveData = {\n\t\t\tname: event.data.title,\n\t\t\turl: event.data.url,\n\t\t}\n\n\t\tif (OCA.Onlyoffice.filePath) {\n\t\t\tconst arrayPath = OCA.Onlyoffice.filePath.split('/')\n\t\t\tarrayPath.pop()\n\t\t\tarrayPath.shift()\n\t\t\tsaveData.dir = '/' + arrayPath.join('/')\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestSaveAs',\n\t\t\t\tparam: saveData,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Save as'),\n\t\t\t\tfunction(fileDir) {\n\t\t\t\t\tsaveData.dir = fileDir\n\t\t\t\t\tOCA.Onlyoffice.editorSaveAs(saveData)\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\t'httpd/unix-directory',\n\t\t\t\ttrue,\n\t\t\t\tOC.dialogs.FILEPICKER_TYPE_CHOOSE,\n\t\t\t\tsaveData.dir)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorSaveAs = function(saveData) {\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/save'),\n\t\t\tsaveData,\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'File saved') + ' (' + response.name + ')')\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestInsertImage = function(event) {\n\t\tconst imageMimes = [\n\t\t\t'image/bmp', 'image/x-bmp', 'image/x-bitmap', 'application/bmp',\n\t\t\t'image/gif', 'image/tiff',\n\t\t\t'image/jpeg', 'image/jpg', 'application/jpg', 'application/x-jpg',\n\t\t\t'image/png', 'image/x-png', 'application/png', 'application/x-png',\n\t\t\t'image/svg+xml',\n\t\t]\n\n\t\tif (event.data) {\n\t\t\tOCA.Onlyoffice.insertImageType = event.data.c\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestInsertImage',\n\t\t\t\tparam: imageMimes,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Insert image'),\n\t\t\t\tOCA.Onlyoffice.editorInsertImage,\n\t\t\t\tfalse,\n\t\t\t\timageMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorInsertImage = function(filePath) {\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/url?filePath={filePath}',\n\t\t\t{\n\t\t\t\tfilePath,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (OCA.Onlyoffice.insertImageType) {\n\t\t\t\tresponse.c = OCA.Onlyoffice.insertImageType\n\t\t\t}\n\n\t\t\tOCA.Onlyoffice.docEditor.insertImage(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestMailMergeRecipients = function() {\n\t\tconst recipientMimes = [\n\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t]\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestMailMergeRecipients',\n\t\t\t\tparam: recipientMimes,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Select recipients'),\n\t\t\t\tOCA.Onlyoffice.editorSetRecipient,\n\t\t\t\tfalse,\n\t\t\t\trecipientMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorSetRecipient = function(filePath) {\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/url?filePath={filePath}',\n\t\t\t{\n\t\t\t\tfilePath,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tOCA.Onlyoffice.docEditor.setMailMergeRecipients(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.editorReferenceSource = function(filePath) {\n\t\tif (filePath === OCA.Onlyoffice.filePath) {\n\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'The data source must not be the current document'), 'error')\n\t\t\treturn\n\t\t}\n\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/reference'),\n\t\t\t{\n\t\t\t\tpath: filePath,\n\t\t\t},\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tOCA.Onlyoffice.docEditor.setReferenceSource(response)\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestClose = function() {\n\t\tif (OCA.Onlyoffice.directEditor) {\n\t\t\tOCA.Onlyoffice.directEditor.close()\n\t\t\treturn\n\t\t}\n\n\t\tOCA.Onlyoffice.docEditor.destroyEditor()\n\n\t\twindow.parent.postMessage({\n\t\t\tmethod: 'editorRequestClose',\n\t\t},\n\t\t'*')\n\t}\n\n\tOCA.Onlyoffice.onRequestSharingSettings = function() {\n\t\twindow.parent.postMessage({\n\t\t\tmethod: 'editorRequestSharingSettings',\n\t\t},\n\t\t'*')\n\t}\n\n\tOCA.Onlyoffice.onRequestSelectDocument = function(event) {\n\t\tconst revisedMimes = [\n\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t]\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestSelectDocument',\n\t\t\t\tparam: revisedMimes,\n\t\t\t\tdocumentSelectionType: event.data.c,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tlet title\n\t\t\tswitch (event.data.c) {\n\t\t\tcase 'combine':\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file to combine')\n\t\t\t\tbreak\n\t\t\tcase 'compare':\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file to compare')\n\t\t\t\tbreak\n\t\t\tcase 'insert-text':\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file to insert text')\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file')\n\t\t\t}\n\t\t\tOC.dialogs.filepicker(title,\n\t\t\t\tOCA.Onlyoffice.editorSetRequested.bind({ documentSelectionType: event.data.c }),\n\t\t\t\tfalse,\n\t\t\t\trevisedMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorSetRequested = function(filePath) {\n\t\tconst documentSelectionType = this.documentSelectionType\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/url?filePath={filePath}',\n\t\t\t{\n\t\t\t\tfilePath,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tOCP.Toast.error(response.error)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tresponse.c = documentSelectionType\n\n\t\t\tOCA.Onlyoffice.docEditor.setRequestedDocument(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onMakeActionLink = function(event) {\n\t\tlet url = location.href\n\t\tif (event && event.data) {\n\t\t\tconst indexAnchor = url.indexOf('#')\n\t\t\tif (parseInt(indexAnchor) !== -1) {\n\t\t\t\turl = url.substring(0, indexAnchor)\n\t\t\t}\n\n\t\t\tlet data = JSON.stringify(event.data)\n\t\t\tdata = 'anchor=' + encodeURIComponent(data)\n\n\t\t\tconst inframeRegex = /inframe=([^&]*&?)/g\n\t\t\tif (inframeRegex.test(url)) {\n\t\t\t\turl = url.replace(inframeRegex, data)\n\t\t\t}\n\n\t\t\tconst anchorRegex = /anchor=([^&]*)/g\n\t\t\tif (anchorRegex.test(url)) {\n\t\t\t\turl = url.replace(anchorRegex, data)\n\t\t\t} else {\n\t\t\t\turl += (url.indexOf('?') === -1) ? '?' : '&'\n\t\t\t\turl += data\n\t\t\t}\n\t\t}\n\n\t\tOCA.Onlyoffice.docEditor.setActionLink(url)\n\t}\n\n\tOCA.Onlyoffice.onRequestUsers = function(event) {\n\t\tconst operationType = typeof (event.data.c) !== 'undefined' ? event.data.c : null\n\t\tswitch (operationType) {\n\t\tcase 'info': {\n\t\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/userInfo?userIds={userIds}',\n\t\t\t\t{\n\t\t\t\t\tuserIds: JSON.stringify(event.data.id),\n\t\t\t\t}),\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tOCA.Onlyoffice.docEditor.setUsers({\n\t\t\t\t\tc: operationType,\n\t\t\t\t\tusers: response,\n\t\t\t\t})\n\t\t\t})\n\t\t\tbreak\n\t\t}\n\t\tdefault: {\n\t\t\tlet requestString = 'apps/' + OCA.Onlyoffice.AppName + '/ajax/users?fileId={fileId}&operationType=' + operationType\n\t\t\tif (typeof (event.data.search) !== 'undefined') {\n\t\t\t\trequestString += '&from=' + event.data.from + '&count=' + event.data.count + '&search=' + encodeURIComponent(event.data.search)\n\t\t\t}\n\t\t\t$.get(OC.generateUrl(requestString,\n\t\t\t\t{\n\t\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t\t}),\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tOCA.Onlyoffice.docEditor.setUsers({\n\t\t\t\t\tc: operationType,\n\t\t\t\t\tusers: response,\n\t\t\t\t\t// support v9.0\n\t\t\t\t\ttotal: 1 + (!event.data.count || response.length < event.data.count ? 0 : (event.data.from + event.data.count)),\n\t\t\t\t\t// since v9.0.1\n\t\t\t\t\tisPaginated: true,\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.onRequestSendNotify = function(event) {\n\t\tconst actionLink = event.data.actionLink\n\t\tconst comment = event.data.message\n\t\tconst emails = event.data.emails\n\n\t\tconst fileId = OCA.Onlyoffice.fileId\n\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/mention'),\n\t\t\t{\n\t\t\t\tfileId,\n\t\t\t\tanchor: JSON.stringify(actionLink),\n\t\t\t\tcomment,\n\t\t\t\temails,\n\t\t\t},\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tOCA.Onlyoffice.showMessage(response.message)\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestReferenceData = function(event) {\n\t\tconst link = event.data.link\n\t\tconst referenceData = event.data.referenceData\n\t\tconst path = event.data.path\n\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/reference'),\n\t\t\t{\n\t\t\t\treferenceData,\n\t\t\t\tpath,\n\t\t\t\tlink,\n\t\t\t},\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tOCA.Onlyoffice.docEditor.setReferenceData(response)\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestOpen = function(event) {\n\t\tconst filePath = event.data.path\n\t\tconst fileId = event.data.referenceData.fileKey\n\t\tconst windowName = event.data.windowName\n\t\tconst sourceUrl = OC.generateUrl(`apps/${OCA.Onlyoffice.AppName}/${fileId}?filePath=${OC.encodePath(filePath)}`)\n\t\twindow.open(sourceUrl, windowName)\n\t}\n\n\tOCA.Onlyoffice.onRequestReferenceSource = function(event) {\n\t\tconst referenceSourceMimes = [\n\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t]\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestReferenceSource',\n\t\t\t\tparam: referenceSourceMimes,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Select data source'),\n\t\t\t\tOCA.Onlyoffice.editorReferenceSource,\n\t\t\t\tfalse,\n\t\t\t\treferenceSourceMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.onMetaChange = function(event) {\n\t\tif (event.data.favorite !== undefined) {\n\t\t\t$.ajax({\n\t\t\t\turl: OC.generateUrl('apps/files/api/v1/files' + OC.encodePath(OCA.Onlyoffice.filePath)),\n\t\t\t\ttype: 'post',\n\t\t\t\tdata: JSON.stringify({\n\t\t\t\t\ttags: event.data.favorite ? [OC.TAG_FAVORITE] : [],\n\t\t\t\t}),\n\t\t\t\tcontentType: 'application/json',\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess() {\n\t\t\t\t\tOCA.Onlyoffice.docEditor.setFavorite(event.data.favorite)\n\t\t\t\t},\n\t\t\t})\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.onRequestRefreshFile = function() {\n\t\tconst configUrl = OCA.Onlyoffice.getConfigUrl()\n\t\t$.ajax({\n\t\t\turl: configUrl,\n\t\t\tsuccess: function onSuccess(config) {\n\t\t\t\tOCA.Onlyoffice.docEditor.refreshFile(config)\n\t\t\t},\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.showMessage = function(message, type = 'success', props = null) {\n\t\tif (OCA.Onlyoffice.directEditor) {\n\t\t\tOCA.Onlyoffice.directEditor.loaded()\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'onShowMessage',\n\t\t\t\tparam: {\n\t\t\t\t\tmessage,\n\t\t\t\t\ttype,\n\t\t\t\t\tprops,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'*')\n\t\t\treturn\n\t\t}\n\n\t\tswitch (type) {\n\t\tcase 'success':\n\t\t\tOCP.Toast.success(message, props)\n\t\t\tbreak\n\t\tcase 'error':\n\t\t\tOCP.Toast.error(message, props)\n\t\t\tbreak\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.refreshHistory = function(response, version) {\n\t\tlet data = {}\n\t\tif (response.error) {\n\t\t\tdata = { error: response.error }\n\t\t} else {\n\t\t\tlet currentVersion = 0\n\t\t\t$.each(response, function(i, fileVersion) {\n\t\t\t\tif (fileVersion.version >= currentVersion) {\n\t\t\t\t\tcurrentVersion = fileVersion.version\n\t\t\t\t}\n\n\t\t\t\tfileVersion.created = moment(fileVersion.created * 1000).format('L LTS')\n\t\t\t\tif (fileVersion.changes) {\n\t\t\t\t\t$.each(fileVersion.changes, function(j, change) {\n\t\t\t\t\t\tchange.created = moment(change.created + '+00:00').format('L LTS')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif (version) {\n\t\t\t\tcurrentVersion = Math.min(currentVersion, version)\n\t\t\t}\n\n\t\t\tdata = {\n\t\t\t\tcurrentVersion,\n\t\t\t\thistory: response,\n\t\t\t}\n\t\t}\n\t\tOCA.Onlyoffice.docEditor.refreshHistory(data)\n\t}\n\n\tOCA.Onlyoffice.resize = function() {\n\t\tif (OCA.Onlyoffice.device !== 'mobile') {\n\t\t\treturn\n\t\t}\n\n\t\tconst headerHeight = $('header#header').length > 0 ? $('header#header').height() : 50\n\t\tconst headerEscoHeight = $('#escoDiv').length > 0 ? $('#escoDiv').height() : 0\n\t\tconst totalHeaderHeight = headerHeight + headerEscoHeight\n\t\tconst wrapEl = $('#app>iframe')\n\t\tif (wrapEl.length > 0) {\n\t\t\twrapEl[0].style.height = (screen.availHeight - totalHeaderHeight) + 'px'\n\t\t\twindow.scrollTo(0, -1)\n\t\t\twrapEl[0].style.height = (window.top.innerHeight - totalHeaderHeight) + 'px'\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.resizeEvents = function() {\n\t\tif (window.addEventListener) {\n\t\t\tif (/Android/i.test(navigator.userAgent)) {\n\t\t\t\twindow.addEventListener('resize', OCA.Onlyoffice.resize)\n\t\t\t}\n\t\t\tif (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {\n\t\t\t\twindow.addEventListener('orientationchange', OCA.Onlyoffice.resize)\n\t\t\t}\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.setViewport = function() {\n\t\tdocument.querySelector('meta[name=\"viewport\"]').setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0')\n\t}\n\n\tOCA.Onlyoffice.getConfigUrl = function() {\n\t\tconst guestName = localStorage.getItem('nick')\n\t\tlet configUrl = OC.linkToOCS('apps/' + OCA.Onlyoffice.AppName + '/api/v1/config', 2) + (OCA.Onlyoffice.fileId || 0)\n\n\t\tconst params = []\n\t\tif (OCA.Onlyoffice.filePath) {\n\t\t\tparams.push('filePath=' + encodeURIComponent(OCA.Onlyoffice.filePath))\n\t\t}\n\t\tif (OCA.Onlyoffice.shareToken) {\n\t\t\tparams.push('shareToken=' + encodeURIComponent(OCA.Onlyoffice.shareToken))\n\t\t}\n\t\tif (OCA.Onlyoffice.directToken) {\n\t\t\t$('html').addClass('onlyoffice-full-page')\n\t\t\tparams.push('directToken=' + encodeURIComponent(OCA.Onlyoffice.directToken))\n\t\t}\n\t\tif (OCA.Onlyoffice.template) {\n\t\t\tparams.push('template=true')\n\t\t}\n\t\tif (guestName && guestName !== 'null') {\n\t\t\tparams.push('guestName=' + encodeURIComponent(guestName))\n\t\t}\n\t\tif (OCA.Onlyoffice.anchor) {\n\t\t\tparams.push('anchor=' + encodeURIComponent(OCA.Onlyoffice.anchor))\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe || OCA.Onlyoffice.directToken) {\n\t\t\tparams.push('inframe=true')\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inviewer) {\n\t\t\tparams.push('inviewer=true')\n\t\t}\n\n\t\tif (OCA.Onlyoffice.Desktop) {\n\t\t\tparams.push('desktop=true')\n\t\t}\n\t\tif (params.length) {\n\t\t\tconfigUrl += '?' + params.join('&')\n\t\t}\n\n\t\treturn configUrl\n\t}\n\n\tOCA.Onlyoffice.InitEditor()\n\n})(jQuery, OCA)\n"],"names":["$","OCA","Onlyoffice","_","extend","AppName","inframe","inviewer","fileId","shareToken","insertImageType","InitEditor","data","directToken","template","filePath","anchor","attr","currentWindow","window","currentUser","OC","getCurrentUser","parent","showMessage","t","timeout","configUrl","getConfigUrl","ajax","url","success","config","device","type","resizeEvents","redirectUrl","location","href","error","documentServerUrl","script","document","createElement","src","key","setAttribute","btoa","requestToken","onerror","onload","DocsAPI","docsVersion","DocEditor","version","split","parseInt","docIsChanged","docIsChangedTimeout","setPageTitle","event","clearTimeout","titleChange","title","oc_defaults","setTimeout","documentType","events","onDocumentStateChange","onDocumentReady","onMakeActionLink","editorConfig","tenant","onAppReady","docEditor","uid","onRequestSaveAs","onRequestInsertImage","onRequestMailMergeRecipients","onRequestCompareFile","onRequestSelectDocument","onRequestSendNotify","onRequestReferenceData","onRequestOpen","onRequestReferenceSource","onMetaChange","onRequestRefreshFile","onRequestUsers","_file_path","onRequestHistory","onRequestHistoryData","onRequestRestore","onRequestHistoryClose","directEditor","onRequestClose","_files_sharing","context","onRequestSharingSettings","loaded","css","favicon","postMessage","method","param","head","appendChild","get","generateUrl","response","refreshHistory","setHistoryData","at","reload","resize","setViewport","saveData","name","arrayPath","pop","shift","dir","join","dialogs","filepicker","fileDir","editorSaveAs","FILEPICKER_TYPE_CHOOSE","post","imageMimes","c","editorInsertImage","insertImage","recipientMimes","editorSetRecipient","setMailMergeRecipients","editorReferenceSource","path","setReferenceSource","close","destroyEditor","revisedMimes","documentSelectionType","editorSetRequested","bind","this","OCP","Toast","setRequestedDocument","indexAnchor","indexOf","substring","JSON","stringify","encodeURIComponent","inframeRegex","test","replace","anchorRegex","setActionLink","operationType","userIds","id","setUsers","users","requestString","search","from","count","total","length","isPaginated","actionLink","comment","message","emails","link","referenceData","setReferenceData","fileKey","windowName","sourceUrl","encodePath","open","referenceSourceMimes","undefined","favorite","tags","TAG_FAVORITE","contentType","dataType","setFavorite","refreshFile","props","currentVersion","each","i","fileVersion","created","moment","format","changes","j","change","Math","min","history","totalHeaderHeight","height","wrapEl","style","screen","availHeight","scrollTo","top","innerHeight","addEventListener","navigator","userAgent","querySelector","guestName","localStorage","getItem","linkToOCS","params","push","addClass","Desktop","jQuery"],"sourceRoot":""}
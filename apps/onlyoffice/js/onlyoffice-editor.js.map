{"version":3,"file":"onlyoffice-editor.js?v=a4be999105b387b5ba40","mappings":"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","sources":["webpack:///onlyoffice/src/editor.js"],"sourcesContent":["/**\n *\n * (c) Copyright Ascensio System SIA 2025\n *\n * This program is a free software product.\n * You can redistribute it and/or modify it under the terms of the GNU Affero General Public License\n * (AGPL) version 3 as published by the Free Software Foundation.\n * In accordance with Section 7(a) of the GNU AGPL its Section 15 shall be amended to the effect\n * that Ascensio System SIA expressly excludes the warranty of non-infringement of any third-party rights.\n *\n * This program is distributed WITHOUT ANY WARRANTY;\n * without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\n * For details, see the GNU AGPL at: http://www.gnu.org/licenses/agpl-3.0.html\n *\n * You can contact Ascensio System SIA at 20A-12 Ernesta Birznieka-Upisha street, Riga, Latvia, EU, LV-1050.\n *\n * The interactive user interfaces in modified source and object code versions of the Program\n * must display Appropriate Legal Notices, as required under Section 5 of the GNU AGPL version 3.\n *\n * Pursuant to Section 7(b) of the License you must retain the original Product logo when distributing the program.\n * Pursuant to Section 7(e) we decline to grant you any rights under trademark law for use of our trademarks.\n *\n * All the Product's GUI elements, including illustrations and icon sets, as well as technical\n * writing content are licensed under the terms of the Creative Commons Attribution-ShareAlike 4.0 International.\n * See the License terms at http://creativecommons.org/licenses/by-sa/4.0/legalcode\n *\n */\n\n/* global _, DocsAPI, jQuery, moment, oc_defaults */\n\n/**\n * @param {object} $ JQueryStatic object\n * @param {object} OCA Nextcloud OCA object\n */\n(function($, OCA) {\n\n\tOCA.Onlyoffice = _.extend({\n\t\tAppName: 'onlyoffice',\n\t\tinframe: false,\n\t\tinviewer: false,\n\t\tfileId: null,\n\t\tshareToken: null,\n\t\tinsertImageType: null,\n\t}, OCA.Onlyoffice)\n\n\tOCA.Onlyoffice.InitEditor = function() {\n\n\t\tOCA.Onlyoffice.fileId = $('#iframeEditor').data('id')\n\t\tOCA.Onlyoffice.shareToken = $('#iframeEditor').data('sharetoken')\n\t\tconst directToken = $('#iframeEditor').data('directtoken')\n\t\tOCA.Onlyoffice.template = $('#iframeEditor').data('template')\n\t\tOCA.Onlyoffice.inframe = !!$('#iframeEditor').data('inframe')\n\t\tOCA.Onlyoffice.inviewer = !!$('#iframeEditor').data('inviewer')\n\t\tOCA.Onlyoffice.filePath = $('#iframeEditor').data('path')\n\t\tOCA.Onlyoffice.anchor = $('#iframeEditor').attr('data-anchor')\n\t\tconst guestName = localStorage.getItem('nick')\n\t\tOCA.Onlyoffice.currentWindow = window\n\t\tOCA.Onlyoffice.currentUser = OC.getCurrentUser()\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\tOCA.Onlyoffice.currentWindow = window.parent\n\t\t\tOCA.Onlyoffice.currentUser = OCA.Onlyoffice.currentWindow.OC.getCurrentUser()\n\t\t}\n\n\t\tif (!OCA.Onlyoffice.fileId && !OCA.Onlyoffice.shareToken && !directToken) {\n\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'FileId is empty'), 'error', { timeout: -1 })\n\t\t\treturn\n\t\t}\n\n\t\tlet configUrl = OC.linkToOCS('apps/' + OCA.Onlyoffice.AppName + '/api/v1/config', 2) + (OCA.Onlyoffice.fileId || 0)\n\n\t\tconst params = []\n\t\tconst filePath = $('#iframeEditor').data('path')\n\t\tif (filePath) {\n\t\t\tparams.push('filePath=' + encodeURIComponent(filePath))\n\t\t}\n\t\tif (OCA.Onlyoffice.shareToken) {\n\t\t\tparams.push('shareToken=' + encodeURIComponent(OCA.Onlyoffice.shareToken))\n\t\t}\n\t\tif (directToken) {\n\t\t\t$('html').addClass('onlyoffice-full-page')\n\t\t\tparams.push('directToken=' + encodeURIComponent(directToken))\n\t\t}\n\t\tif (OCA.Onlyoffice.template) {\n\t\t\tparams.push('template=true')\n\t\t}\n\t\tif (guestName && guestName !== 'null') {\n\t\t\tparams.push('guestName=' + encodeURIComponent(guestName))\n\t\t}\n\t\tif (OCA.Onlyoffice.anchor) {\n\t\t\tparams.push('anchor=' + encodeURIComponent(OCA.Onlyoffice.anchor))\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe || directToken) {\n\t\t\tparams.push('inframe=true')\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inviewer) {\n\t\t\tparams.push('inviewer=true')\n\t\t}\n\n\t\tif (OCA.Onlyoffice.Desktop) {\n\t\t\tparams.push('desktop=true')\n\t\t}\n\t\tif (params.length) {\n\t\t\tconfigUrl += '?' + params.join('&')\n\t\t}\n\n\t\t$.ajax({\n\t\t\turl: configUrl,\n\t\t\tsuccess: function onSuccess(config) {\n\t\t\t\tif (config) {\n\t\t\t\t\tOCA.Onlyoffice.device = config.type\n\t\t\t\t\tif (OCA.Onlyoffice.device === 'mobile') {\n\t\t\t\t\t\tOCA.Onlyoffice.resizeEvents()\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.redirectUrl) {\n\t\t\t\t\t\tlocation.href = config.redirectUrl\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (config.error != null) {\n\t\t\t\t\t\tOCA.Onlyoffice.showMessage(config.error, 'error', { timeout: -1 })\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!config.documentServerUrl) {\n\t\t\t\t\t\tOCA.Onlyoffice.showMessage('ONLYOFFICE cannot be reached. Please contact admin', 'error', { timeout: -1 })\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\n\n\t\t\t\t\tconst script = document.createElement('script')\n\t\t\t\t\tscript.src = config.documentServerUrl + 'web-apps/apps/api/documents/api.js?shardKey=' + config.document.key\n\t\t\t\t\tscript.setAttribute('nonce', btoa(OC.requestToken))\n\t\t\t\t\tscript.onerror = function() {\n\t\t\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'ONLYOFFICE cannot be reached. Please contact admin'), 'error', { timeout: -1 })\n\t\t\t\t\t}\n\t\t\t\t\tscript.onload = function() {\n\t\t\t\t\t\tif (typeof DocsAPI === 'undefined') {\n\t\t\t\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'ONLYOFFICE cannot be reached. Please contact admin'), 'error', { timeout: -1 })\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst docsVersion = DocsAPI.DocEditor.version().split('.')\n\t\t\t\t\t\tif ((docsVersion[0] < 6)\n\t\t\t\t\t\t\t|| (parseInt(docsVersion[0]) === 6 && parseInt(docsVersion[1]) === 0)) {\n\t\t\t\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'Not supported version'), 'error', { timeout: -1 })\n\t\t\t\t\t\t\treturn\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tlet docIsChanged = null\n\t\t\t\t\t\tlet docIsChangedTimeout = null\n\n\t\t\t\t\t\tconst setPageTitle = function(event) {\n\t\t\t\t\t\t\tclearTimeout(docIsChangedTimeout)\n\n\t\t\t\t\t\t\tif (docIsChanged !== event.data) {\n\t\t\t\t\t\t\t\tconst titleChange = function() {\n\t\t\t\t\t\t\t\t\tOCA.Onlyoffice.currentWindow.document.title = config.document.title + (event.data ? ' *' : '') + ' - ' + oc_defaults.title\n\t\t\t\t\t\t\t\t\tdocIsChanged = event.data\n\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\tif (event === false || event.data) {\n\t\t\t\t\t\t\t\t\ttitleChange()\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdocIsChangedTimeout = setTimeout(titleChange, 500)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsetPageTitle(false)\n\n\t\t\t\t\t\tOCA.Onlyoffice.documentType = config.documentType\n\n\t\t\t\t\t\tconfig.events = {\n\t\t\t\t\t\t\tonDocumentStateChange: setPageTitle,\n\t\t\t\t\t\t\tonDocumentReady: OCA.Onlyoffice.onDocumentReady,\n\t\t\t\t\t\t\tonMakeActionLink: OCA.Onlyoffice.onMakeActionLink,\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (config.editorConfig.tenant) {\n\t\t\t\t\t\t\tconfig.events.onAppReady = function() {\n\t\t\t\t\t\t\t\tOCA.Onlyoffice.docEditor.showMessage(t(OCA.Onlyoffice.AppName, 'You are using public demo ONLYOFFICE Docs server. Please do not store private sensitive data.'))\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif ((OCA.Onlyoffice.inframe && !OCA.Onlyoffice.shareToken)\n\t\t\t\t\t\t\t|| (OCA.Onlyoffice.currentUser.uid)) {\n\t\t\t\t\t\t\tconfig.events.onRequestSaveAs = OCA.Onlyoffice.onRequestSaveAs\n\t\t\t\t\t\t\tconfig.events.onRequestInsertImage = OCA.Onlyoffice.onRequestInsertImage\n\t\t\t\t\t\t\tconfig.events.onRequestMailMergeRecipients = OCA.Onlyoffice.onRequestMailMergeRecipients\n\t\t\t\t\t\t\tconfig.events.onRequestCompareFile = OCA.Onlyoffice.onRequestSelectDocument // todo: remove (for editors 7.4)\n\t\t\t\t\t\t\tconfig.events.onRequestSelectDocument = OCA.Onlyoffice.onRequestSelectDocument\n\t\t\t\t\t\t\tconfig.events.onRequestSendNotify = OCA.Onlyoffice.onRequestSendNotify\n\t\t\t\t\t\t\tconfig.events.onRequestReferenceData = OCA.Onlyoffice.onRequestReferenceData\n\t\t\t\t\t\t\tconfig.events.onRequestOpen = OCA.Onlyoffice.onRequestOpen\n\t\t\t\t\t\t\tconfig.events.onRequestReferenceSource = OCA.Onlyoffice.onRequestReferenceSource\n\t\t\t\t\t\t\tconfig.events.onMetaChange = OCA.Onlyoffice.onMetaChange\n\n\t\t\t\t\t\t\tif (OCA.Onlyoffice.currentUser.uid) {\n\t\t\t\t\t\t\t\tconfig.events.onRequestUsers = OCA.Onlyoffice.onRequestUsers\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!OCA.Onlyoffice.filePath) {\n\t\t\t\t\t\t\t\tOCA.Onlyoffice.filePath = config._file_path\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (!OCA.Onlyoffice.template) {\n\t\t\t\t\t\t\t\tconfig.events.onRequestHistory = OCA.Onlyoffice.onRequestHistory\n\t\t\t\t\t\t\t\tconfig.events.onRequestHistoryData = OCA.Onlyoffice.onRequestHistoryData\n\t\t\t\t\t\t\t\tconfig.events.onRequestRestore = OCA.Onlyoffice.onRequestRestore\n\t\t\t\t\t\t\t\tconfig.events.onRequestHistoryClose = OCA.Onlyoffice.onRequestHistoryClose\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (OCA.Onlyoffice.directEditor || OCA.Onlyoffice.inframe) {\n\t\t\t\t\t\t\tconfig.events.onRequestClose = OCA.Onlyoffice.onRequestClose\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (OCA.Onlyoffice.inframe\n\t\t\t\t\t\t\t&& config._files_sharing && !OCA.Onlyoffice.shareToken\n\t\t\t\t\t\t\t&& window.parent.OCA.Onlyoffice.context) {\n\t\t\t\t\t\t\tconfig.events.onRequestSharingSettings = OCA.Onlyoffice.onRequestSharingSettings\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tOCA.Onlyoffice.docEditor = new DocsAPI.DocEditor('iframeEditor', config)\n\n\t\t\t\t\t\tif (OCA.Onlyoffice.directEditor) {\n\t\t\t\t\t\t\tOCA.Onlyoffice.directEditor.loaded()\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (!OCA.Onlyoffice.directEditor\n\t\t\t\t\t\t\t&& config.type === 'mobile' && $('#app > iframe').css('position') === 'fixed') {\n\t\t\t\t\t\t\t$('#app > iframe').css('height', 'calc(100% - 50px)')\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst favicon = OC.filePath(OCA.Onlyoffice.AppName, 'img', OCA.Onlyoffice.documentType + '.ico')\n\t\t\t\t\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\t\t\t\t\twindow.parent.postMessage({\n\t\t\t\t\t\t\t\tmethod: 'changeFavicon',\n\t\t\t\t\t\t\t\tparam: favicon,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t'*')\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$('link[rel=\"icon\"]').attr('href', favicon)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tdocument.head.appendChild(script)\n\t\t\t\t}\n\t\t\t},\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestHistory = function(version) {\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/history?fileId={fileId}',\n\t\t\t{\n\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tOCA.Onlyoffice.refreshHistory(response, version)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestHistoryData = function(event) {\n\t\tconst version = event.data\n\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/version?fileId={fileId}&version={version}',\n\t\t\t{\n\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t\tversion,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tresponse = {\n\t\t\t\t\terror: response.error,\n\t\t\t\t\tversion,\n\t\t\t\t}\n\t\t\t}\n\t\t\tOCA.Onlyoffice.docEditor.setHistoryData(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestRestore = function(event) {\n\t\tconst version = event.data.version\n\n\t\t$.ajax({\n\t\t\tmethod: 'PUT',\n\t\t\turl: OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/restore'),\n\t\t\tdata: {\n\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t\tversion,\n\t\t\t},\n\t\t\tsuccess: function onSuccess(response) {\n\t\t\t\tOCA.Onlyoffice.refreshHistory(response, version)\n\n\t\t\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\t\t\twindow.parent.postMessage({\n\t\t\t\t\t\tmethod: 'onRefreshVersionsDialog',\n\t\t\t\t\t},\n\t\t\t\t\t'*')\n\t\t\t\t}\n\t\t\t},\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestHistoryClose = function() {\n\t\tlocation.reload(true)\n\t}\n\n\tOCA.Onlyoffice.onDocumentReady = function() {\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'onDocumentReady',\n\t\t\t\tparam: {},\n\t\t\t},\n\t\t\t'*')\n\t\t}\n\n\t\tOCA.Onlyoffice.resize()\n\t\tOCA.Onlyoffice.setViewport()\n\t}\n\n\tOCA.Onlyoffice.onRequestSaveAs = function(event) {\n\t\tconst saveData = {\n\t\t\tname: event.data.title,\n\t\t\turl: event.data.url,\n\t\t}\n\n\t\tif (OCA.Onlyoffice.filePath) {\n\t\t\tconst arrayPath = OCA.Onlyoffice.filePath.split('/')\n\t\t\tarrayPath.pop()\n\t\t\tarrayPath.shift()\n\t\t\tsaveData.dir = '/' + arrayPath.join('/')\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestSaveAs',\n\t\t\t\tparam: saveData,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Save as'),\n\t\t\t\tfunction(fileDir) {\n\t\t\t\t\tsaveData.dir = fileDir\n\t\t\t\t\tOCA.Onlyoffice.editorSaveAs(saveData)\n\t\t\t\t},\n\t\t\t\tfalse,\n\t\t\t\t'httpd/unix-directory',\n\t\t\t\ttrue,\n\t\t\t\tOC.dialogs.FILEPICKER_TYPE_CHOOSE,\n\t\t\t\tsaveData.dir)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorSaveAs = function(saveData) {\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/save'),\n\t\t\tsaveData,\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'File saved') + ' (' + response.name + ')')\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestInsertImage = function(event) {\n\t\tconst imageMimes = [\n\t\t\t'image/bmp', 'image/x-bmp', 'image/x-bitmap', 'application/bmp',\n\t\t\t'image/gif', 'image/tiff',\n\t\t\t'image/jpeg', 'image/jpg', 'application/jpg', 'application/x-jpg',\n\t\t\t'image/png', 'image/x-png', 'application/png', 'application/x-png',\n\t\t]\n\n\t\tif (event.data) {\n\t\t\tOCA.Onlyoffice.insertImageType = event.data.c\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestInsertImage',\n\t\t\t\tparam: imageMimes,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Insert image'),\n\t\t\t\tOCA.Onlyoffice.editorInsertImage,\n\t\t\t\tfalse,\n\t\t\t\timageMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorInsertImage = function(filePath) {\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/url?filePath={filePath}',\n\t\t\t{\n\t\t\t\tfilePath,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tif (OCA.Onlyoffice.insertImageType) {\n\t\t\t\tresponse.c = OCA.Onlyoffice.insertImageType\n\t\t\t}\n\n\t\t\tOCA.Onlyoffice.docEditor.insertImage(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestMailMergeRecipients = function() {\n\t\tconst recipientMimes = [\n\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t]\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestMailMergeRecipients',\n\t\t\t\tparam: recipientMimes,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Select recipients'),\n\t\t\t\tOCA.Onlyoffice.editorSetRecipient,\n\t\t\t\tfalse,\n\t\t\t\trecipientMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorSetRecipient = function(filePath) {\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/url?filePath={filePath}',\n\t\t\t{\n\t\t\t\tfilePath,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\tOCA.Onlyoffice.docEditor.setMailMergeRecipients(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.editorReferenceSource = function(filePath) {\n\t\tif (filePath === OCA.Onlyoffice.filePath) {\n\t\t\tOCA.Onlyoffice.showMessage(t(OCA.Onlyoffice.AppName, 'The data source must not be the current document'), 'error')\n\t\t\treturn\n\t\t}\n\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/reference'),\n\t\t\t{\n\t\t\t\tpath: filePath,\n\t\t\t},\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\t\t\t\tOCA.Onlyoffice.docEditor.setReferenceSource(response)\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestClose = function() {\n\t\tif (OCA.Onlyoffice.directEditor) {\n\t\t\tOCA.Onlyoffice.directEditor.close()\n\t\t\treturn\n\t\t}\n\n\t\tOCA.Onlyoffice.docEditor.destroyEditor()\n\n\t\twindow.parent.postMessage({\n\t\t\tmethod: 'editorRequestClose',\n\t\t},\n\t\t'*')\n\t}\n\n\tOCA.Onlyoffice.onRequestSharingSettings = function() {\n\t\twindow.parent.postMessage({\n\t\t\tmethod: 'editorRequestSharingSettings',\n\t\t},\n\t\t'*')\n\t}\n\n\tOCA.Onlyoffice.onRequestSelectDocument = function(event) {\n\t\tconst revisedMimes = [\n\t\t\t'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n\t\t]\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestSelectDocument',\n\t\t\t\tparam: revisedMimes,\n\t\t\t\tdocumentSelectionType: event.data.c,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tlet title\n\t\t\tswitch (event.data.c) {\n\t\t\tcase 'combine':\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file to combine')\n\t\t\t\tbreak\n\t\t\tcase 'compare':\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file to compare')\n\t\t\t\tbreak\n\t\t\tcase 'insert-text':\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file to insert text')\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\ttitle = t(OCA.Onlyoffice.AppName, 'Select file')\n\t\t\t}\n\t\t\tOC.dialogs.filepicker(title,\n\t\t\t\tOCA.Onlyoffice.editorSetRequested.bind({ documentSelectionType: event.data.c }),\n\t\t\t\tfalse,\n\t\t\t\trevisedMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.editorSetRequested = function(filePath) {\n\t\tconst documentSelectionType = this.documentSelectionType\n\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/url?filePath={filePath}',\n\t\t\t{\n\t\t\t\tfilePath,\n\t\t\t}),\n\t\tfunction onSuccess(response) {\n\t\t\tif (response.error) {\n\t\t\t\tOCP.Toast.error(response.error)\n\t\t\t\treturn\n\t\t\t}\n\t\t\tresponse.c = documentSelectionType\n\n\t\t\tOCA.Onlyoffice.docEditor.setRequestedDocument(response)\n\t\t})\n\t}\n\n\tOCA.Onlyoffice.onMakeActionLink = function(event) {\n\t\tlet url = location.href\n\t\tif (event && event.data) {\n\t\t\tconst indexAnchor = url.indexOf('#')\n\t\t\tif (parseInt(indexAnchor) !== -1) {\n\t\t\t\turl = url.substring(0, indexAnchor)\n\t\t\t}\n\n\t\t\tlet data = JSON.stringify(event.data)\n\t\t\tdata = 'anchor=' + encodeURIComponent(data)\n\n\t\t\tconst inframeRegex = /inframe=([^&]*&?)/g\n\t\t\tif (inframeRegex.test(url)) {\n\t\t\t\turl = url.replace(inframeRegex, data)\n\t\t\t}\n\n\t\t\tconst anchorRegex = /anchor=([^&]*)/g\n\t\t\tif (anchorRegex.test(url)) {\n\t\t\t\turl = url.replace(anchorRegex, data)\n\t\t\t} else {\n\t\t\t\turl += (url.indexOf('?') === -1) ? '?' : '&'\n\t\t\t\turl += data\n\t\t\t}\n\t\t}\n\n\t\tOCA.Onlyoffice.docEditor.setActionLink(url)\n\t}\n\n\tOCA.Onlyoffice.onRequestUsers = function(event) {\n\t\tconst operationType = typeof (event.data.c) !== 'undefined' ? event.data.c : null\n\t\tswitch (operationType) {\n\t\tcase 'info':\n\t\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/userInfo?userIds={userIds}',\n\t\t\t\t{\n\t\t\t\t\tuserIds: JSON.stringify(event.data.id),\n\t\t\t\t}),\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tOCA.Onlyoffice.docEditor.setUsers({\n\t\t\t\t\tc: operationType,\n\t\t\t\t\tusers: response,\n\t\t\t\t})\n\t\t\t})\n\t\t\tbreak\n\t\tdefault:\n\t\t\t$.get(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/users?fileId={fileId}&operationType=' + operationType,\n\t\t\t\t{\n\t\t\t\t\tfileId: OCA.Onlyoffice.fileId || 0,\n\t\t\t\t}),\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tOCA.Onlyoffice.docEditor.setUsers({\n\t\t\t\t\tc: operationType,\n\t\t\t\t\tusers: response,\n\t\t\t\t})\n\t\t\t})\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.onRequestSendNotify = function(event) {\n\t\tconst actionLink = event.data.actionLink\n\t\tconst comment = event.data.message\n\t\tconst emails = event.data.emails\n\n\t\tconst fileId = OCA.Onlyoffice.fileId\n\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/mention'),\n\t\t\t{\n\t\t\t\tfileId,\n\t\t\t\tanchor: JSON.stringify(actionLink),\n\t\t\t\tcomment,\n\t\t\t\temails,\n\t\t\t},\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tOCA.Onlyoffice.showMessage(response.message)\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestReferenceData = function(event) {\n\t\tconst link = event.data.link\n\t\tconst referenceData = event.data.referenceData\n\t\tconst path = event.data.path\n\n\t\t$.post(OC.generateUrl('apps/' + OCA.Onlyoffice.AppName + '/ajax/reference'),\n\t\t\t{\n\t\t\t\treferenceData,\n\t\t\t\tpath,\n\t\t\t\tlink,\n\t\t\t},\n\t\t\tfunction onSuccess(response) {\n\t\t\t\tif (response.error) {\n\t\t\t\t\tOCA.Onlyoffice.showMessage(response.error, 'error')\n\t\t\t\t\treturn\n\t\t\t\t}\n\n\t\t\t\tOCA.Onlyoffice.docEditor.setReferenceData(response)\n\t\t\t})\n\t}\n\n\tOCA.Onlyoffice.onRequestOpen = function(event) {\n\t\tconst filePath = event.data.path\n\t\tconst fileId = event.data.referenceData.fileKey\n\t\tconst windowName = event.data.windowName\n\t\tconst sourceUrl = OC.generateUrl(`apps/${OCA.Onlyoffice.AppName}/${fileId}?filePath=${OC.encodePath(filePath)}`)\n\t\twindow.open(sourceUrl, windowName)\n\t}\n\n\tOCA.Onlyoffice.onRequestReferenceSource = function(event) {\n\t\tconst referenceSourceMimes = [\n\t\t\t'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n\t\t]\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'editorRequestReferenceSource',\n\t\t\t\tparam: referenceSourceMimes,\n\t\t\t},\n\t\t\t'*')\n\t\t} else {\n\t\t\tOC.dialogs.filepicker(t(OCA.Onlyoffice.AppName, 'Select data source'),\n\t\t\t\tOCA.Onlyoffice.editorReferenceSource,\n\t\t\t\tfalse,\n\t\t\t\treferenceSourceMimes,\n\t\t\t\ttrue)\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.onMetaChange = function(event) {\n\t\tif (event.data.favorite !== undefined) {\n\t\t\t$.ajax({\n\t\t\t\turl: OC.generateUrl('apps/files/api/v1/files' + OC.encodePath(OCA.Onlyoffice.filePath)),\n\t\t\t\ttype: 'post',\n\t\t\t\tdata: JSON.stringify({\n\t\t\t\t\ttags: event.data.favorite ? [OC.TAG_FAVORITE] : [],\n\t\t\t\t}),\n\t\t\t\tcontentType: 'application/json',\n\t\t\t\tdataType: 'json',\n\t\t\t\tsuccess() {\n\t\t\t\t\tOCA.Onlyoffice.docEditor.setFavorite(event.data.favorite)\n\t\t\t\t},\n\t\t\t})\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.showMessage = function(message, type = 'success', props = null) {\n\t\tif (OCA.Onlyoffice.directEditor) {\n\t\t\tOCA.Onlyoffice.directEditor.loaded()\n\t\t}\n\n\t\tif (OCA.Onlyoffice.inframe) {\n\t\t\twindow.parent.postMessage({\n\t\t\t\tmethod: 'onShowMessage',\n\t\t\t\tparam: {\n\t\t\t\t\tmessage,\n\t\t\t\t\ttype,\n\t\t\t\t\tprops,\n\t\t\t\t},\n\t\t\t},\n\t\t\t'*')\n\t\t\treturn\n\t\t}\n\n\t\tswitch (type) {\n\t\tcase 'success':\n\t\t\tOCP.Toast.success(message, props)\n\t\t\tbreak\n\t\tcase 'error':\n\t\t\tOCP.Toast.error(message, props)\n\t\t\tbreak\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.refreshHistory = function(response, version) {\n\t\tlet data = {}\n\t\tif (response.error) {\n\t\t\tdata = { error: response.error }\n\t\t} else {\n\t\t\tlet currentVersion = 0\n\t\t\t$.each(response, function(i, fileVersion) {\n\t\t\t\tif (fileVersion.version >= currentVersion) {\n\t\t\t\t\tcurrentVersion = fileVersion.version\n\t\t\t\t}\n\n\t\t\t\tfileVersion.created = moment(fileVersion.created * 1000).format('L LTS')\n\t\t\t\tif (fileVersion.changes) {\n\t\t\t\t\t$.each(fileVersion.changes, function(j, change) {\n\t\t\t\t\t\tchange.created = moment(change.created + '+00:00').format('L LTS')\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif (version) {\n\t\t\t\tcurrentVersion = Math.min(currentVersion, version)\n\t\t\t}\n\n\t\t\tdata = {\n\t\t\t\tcurrentVersion,\n\t\t\t\thistory: response,\n\t\t\t}\n\t\t}\n\t\tOCA.Onlyoffice.docEditor.refreshHistory(data)\n\t}\n\n\tOCA.Onlyoffice.resize = function() {\n\t\tif (OCA.Onlyoffice.device !== 'mobile') {\n\t\t\treturn\n\t\t}\n\n\t\tconst headerHeight = $('#header').length > 0 ? $('#header').height() : 50\n\t\tconst headerEscoHeight = $('#escoDiv').length > 0 ? $('#escoDiv').height() : 38\n\t\tconsole.log({ headerHeight, headerEscoHeight })\n\t\tconst wrapEl = $('#app>iframe')\n\t\tif (wrapEl.length > 0) {\n\t\t\twrapEl[0].style.height = (screen.availHeight - (headerHeight + headerEscoHeight)) + 'px'\n\t\t\twindow.scrollTo(0, -1)\n\t\t\twrapEl[0].style.height = (window.top.innerHeight - (headerHeight + headerEscoHeight)) + 'px'\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.resizeEvents = function() {\n\t\tif (window.addEventListener) {\n\t\t\tif (/Android/i.test(navigator.userAgent)) {\n\t\t\t\twindow.addEventListener('resize', OCA.Onlyoffice.resize)\n\t\t\t}\n\t\t\tif (/iPhone|iPad|iPod/i.test(navigator.userAgent)) {\n\t\t\t\twindow.addEventListener('orientationchange', OCA.Onlyoffice.resize)\n\t\t\t}\n\t\t}\n\t}\n\n\tOCA.Onlyoffice.setViewport = function() {\n\t\tdocument.querySelector('meta[name=\"viewport\"]').setAttribute('content', 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0')\n\t}\n\n\tOCA.Onlyoffice.InitEditor()\n\n})(jQuery, OCA)\n"],"names":["$","OCA","Onlyoffice","_","extend","AppName","inframe","inviewer","fileId","shareToken","insertImageType","InitEditor","data","directToken","template","filePath","anchor","attr","guestName","localStorage","getItem","currentWindow","window","currentUser","OC","getCurrentUser","parent","showMessage","t","timeout","configUrl","linkToOCS","params","push","encodeURIComponent","addClass","Desktop","length","join","ajax","url","success","config","device","type","resizeEvents","redirectUrl","location","href","error","documentServerUrl","script","document","createElement","src","key","setAttribute","btoa","requestToken","onerror","onload","DocsAPI","docsVersion","DocEditor","version","split","parseInt","docIsChanged","docIsChangedTimeout","setPageTitle","event","clearTimeout","titleChange","title","oc_defaults","setTimeout","documentType","events","onDocumentStateChange","onDocumentReady","onMakeActionLink","editorConfig","tenant","onAppReady","docEditor","uid","onRequestSaveAs","onRequestInsertImage","onRequestMailMergeRecipients","onRequestCompareFile","onRequestSelectDocument","onRequestSendNotify","onRequestReferenceData","onRequestOpen","onRequestReferenceSource","onMetaChange","onRequestUsers","_file_path","onRequestHistory","onRequestHistoryData","onRequestRestore","onRequestHistoryClose","directEditor","onRequestClose","_files_sharing","context","onRequestSharingSettings","loaded","css","favicon","postMessage","method","param","head","appendChild","get","generateUrl","response","refreshHistory","setHistoryData","reload","resize","setViewport","saveData","name","arrayPath","pop","shift","dir","dialogs","filepicker","fileDir","editorSaveAs","FILEPICKER_TYPE_CHOOSE","post","imageMimes","c","editorInsertImage","insertImage","recipientMimes","editorSetRecipient","setMailMergeRecipients","editorReferenceSource","path","setReferenceSource","close","destroyEditor","revisedMimes","documentSelectionType","editorSetRequested","bind","this","OCP","Toast","setRequestedDocument","indexAnchor","indexOf","substring","JSON","stringify","inframeRegex","test","replace","anchorRegex","setActionLink","operationType","userIds","id","setUsers","users","actionLink","comment","message","emails","link","referenceData","setReferenceData","fileKey","windowName","sourceUrl","encodePath","open","referenceSourceMimes","undefined","favorite","tags","TAG_FAVORITE","contentType","dataType","setFavorite","props","currentVersion","each","i","fileVersion","created","moment","format","changes","j","change","Math","min","history","headerHeight","height","headerEscoHeight","console","log","wrapEl","style","screen","availHeight","scrollTo","top","innerHeight","addEventListener","navigator","userAgent","querySelector","jQuery"],"sourceRoot":""}